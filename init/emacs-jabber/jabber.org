#+PROPERTY: header-args    :results silent
* Jabber
jabber.el aims to be a minimal Jabber client.
http://emacs-jabber.sourceforge.net/
https://www.emacswiki.org/emacs/JabberEl

  #+begin_src emacs-lisp
    (use-package "jabber"
      :ensure t
      :init
      (require 'jabber-autoloads)

      ;; Enable history
      (setq
       jabber-history-enabled t
       jabber-use-global-history nil
       jabber-backlog-number 40
       jabber-backlog-days 30
       )

      ;; Rebind keys for message sending / newlines
      (define-key jabber-chat-mode-map (kbd "RET") 'newline)
      (define-key jabber-chat-mode-map [C-return] 'jabber-chat-buffer-send)
      )
  #+end_src

- =C-x C-j C-h= :: display a list of available jabber commands

** Notifications
https://www.emacswiki.org/emacs/notify.el

#+begin_src emacs-lisp
(require 'notify)

(defun notify-jabber-notify (from buf text proposed-alert)
  "(jabber.el hook) Notify of new Jabber chat messages via notify.el"
  (when (or jabber-message-alert-same-buffer
            (not (memq (selected-window) (get-buffer-window-list buf))))
    (if (jabber-muc-sender-p from)
        (notify (format "(PM) %s"
                       (jabber-jid-displayname (jabber-jid-user from)))
               (format "%s: %s" (jabber-jid-resource from) text)))
      (notify (format "%s" (jabber-jid-displayname from))
             text)))

(add-hook 'jabber-alert-message-hooks 'notify-jabber-notify)
#+end_src>
